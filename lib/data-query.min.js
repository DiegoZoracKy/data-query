/**
 * Query / Filter a set of Object Literal (‘JSON’), that could be an Array or Object Literal.
 *
 * @author Diego ZoracKy, @diegozoracky, http://diegozoracky.com
 *
 * @param   {Array | Object Literal}    dataSrc - Dataset do be filtered / queried
 * @param   {String | Object Literal}   filter - Properties path to be checked
 * @param   {String | Object Literal | RegEx}   filterValue - Value to be checked against the properties path
 * @return  {Array | Object Literal}    Dataset Filtered
 */
var dataQuery=function(){function m(a,b){var c=[],d;for(d in a)c.push(a[d]),b&&(c[c.length-1]._rootKey=d);return c}function n(a,b,c,d){if(a&&b){if(a.constructor==Array)return a.filter(function(a){return b.constructor==Function?b(a):g(a,b,c,d)});if(a.constructor==Object){var f={};a=m(a,!0);a=a.filter(function(a){return b.constructor==Function?b(a):g(a,b,c,d)});for(var e in a)f[a[e]._rootKey]=a[e],delete f[a[e]._rootKey]._rootKey;return f}}}function k(a,b,c){if(void 0===a||void 0===b)return!1;if(b.constructor==Function)return b(a);if(a.constructor==Array&&b.constructor==Array){if(a.length!=b.length)return!1;a.sort();b.sort();return a.every(function(a,c){return a===b[c]})}return a.constructor==Array?a.some(function(a){return b.constructor==RegExp?!!a.toString().match(b):b==a}):b.constructor==Array?b.some(function(b){return b.constructor==RegExp?!!a.toString().match(b):a==b}):b.constructor==Object&&a.constructor==Object?c?h(a,b,"_rootKey"):g(a,b):b.constructor==RegExp?!!a.toString().match(b):a==b}function g(a,b,c,d){var f=!0;if(b.constructor==String)return"undefined"!=typeof c?k(l(a,b),c,d):"undefined"!=typeof l(a,b);if(b.constructor==Object&&(d||c))for(var e in a)f&=h(a,b,"_rootKey");else if(b.constructor==Object)for(e in b)f=e.match(/\./)?f&k(l(a,e),b[e],d):a[e]&&a[e].constructor==Object&&b[e].constructor==Object?f&g(a[e],b[e]):f&k(a[e],b[e],d);return f}function l(a,b){b.split(".").forEach(function(b){if(a){var d=b.match(/^\/(.*)\/$/);d&&(b=new RegExp(d[1],"gi"));b.constructor==RegExp?Object.keys(a).forEach(function(d){d.match(b)&&(a=a[d])}):a=a[b]}});return a}function h(a,b,c){if(a===b)return!0;if(!a||!b||"object"!==typeof a||typeof a!==typeof b)return!1;if(a.constructor===Date&&b.constructor===Date&&a.getTime()===b.getTime())return!0;if(a.constructor===Array&&b.constructor===Array&&a.length===b.length){a=a.slice(0,a.length).sort();b=b.slice(0,b.length).sort();for(var d=0;d<a.length;d++)if(!h(a[d],b[d],c))return!1;return!0}if(!c&&Object.keys(a).length!==Object.keys(b).length)return!1;c&&c.constructor!==Array&&(c=[c]);for(d in a)if(!(c&&0<=c.indexOf(d)||h(a[d],b[d],c)))return!1;for(var f in b)if(!(c&&0<=c.indexOf(f)||f in a))return!1;return!0}return function(a,b,c,d){return n(a,b,c,d)}}();"undefined"!==typeof module&&(module.exports=dataQuery);